# Discovery Bootstrap - å¼•å¯¼èŠ‚ç‚¹å‘ç°

> **ç‰ˆæœ¬**: v1.0.0  
> **çŠ¶æ€**: âœ… å·²å®Œæˆ  
> **æ¶æ„å±‚**: Discovery Layer

---

## æ¦‚è¿°

`bootstrap` è´Ÿè´£é€šè¿‡é¢„é…ç½®çš„å¼•å¯¼èŠ‚ç‚¹è¿›è¡Œåˆå§‹èŠ‚ç‚¹å‘ç°ï¼Œæ˜¯ç½‘ç»œå¯åŠ¨çš„ç¬¬ä¸€æ­¥ã€‚

**æ ¸å¿ƒåŠŸèƒ½**:
- ğŸš€ å¹¶å‘è¿æ¥ - åŒæ—¶è¿æ¥æ‰€æœ‰å¼•å¯¼èŠ‚ç‚¹
- â±ï¸ ç‹¬ç«‹è¶…æ—¶ - æ¯ä¸ªè¿æ¥ç‹¬ç«‹è¶…æ—¶æ§åˆ¶
- âœ… æœ€å°æˆåŠŸæ•° - æ£€æŸ¥æœ€å°æˆåŠŸè¿æ¥æ•°
- ğŸ’¾ åœ°å€æŒä¹…åŒ– - è‡ªåŠ¨å­˜å…¥ Peerstore

---

## å¿«é€Ÿå¼€å§‹

```go
import "github.com/dep2p/go-dep2p/internal/discovery/bootstrap"

// é…ç½®å¼•å¯¼èŠ‚ç‚¹
config := &bootstrap.Config{
    Peers: []types.PeerInfo{
        {
            ID:    types.PeerID("QmBootstrapNode1..."),
            Addrs: []types.Multiaddr{"/ip4/104.131.131.82/tcp/4001"},
        },
    },
    Timeout:  30 * time.Second,
    MinPeers: 4,
}

// åˆ›å»ºå¹¶æ‰§è¡Œå¼•å¯¼
bs, err := bootstrap.New(host, config)
if err != nil {
    log.Fatal(err)
}

if err := bs.Bootstrap(ctx); err != nil {
    log.Printf("bootstrap failed: %v", err)
}

// ä½¿ç”¨ Discovery æ¥å£
peerCh, err := bs.FindPeers(ctx, "namespace")
for peer := range peerCh {
    log.Printf("found peer: %s", peer.ID)
}
```

---

## å¼•å¯¼æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. å¹¶å‘å¯åŠ¨æ‰€æœ‰è¿æ¥ (goroutine + WaitGroup)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. æ¯ä¸ªè¿æ¥ç‹¬ç«‹è¶…æ—¶æ§åˆ¶ (é»˜è®¤ 30s)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. æ·»åŠ åœ°å€åˆ° Peerstore (æ°¸ä¹… TTL)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. æ£€æŸ¥æœ€å°æˆåŠŸè¿æ¥æ•° (é»˜è®¤ 4 ä¸ª)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  5. è¿”å›å¼•å¯¼ç»“æœ                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## é…ç½®

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ |
|------|--------|------|
| `Peers` | `[]` | å¼•å¯¼èŠ‚ç‚¹åˆ—è¡¨ |
| `Timeout` | `30s` | å•ä¸ªèŠ‚ç‚¹è¿æ¥è¶…æ—¶ |
| `MinPeers` | `4` | æœ€å°‘æˆåŠŸè¿æ¥æ•° |

---

## å¤±è´¥å¤„ç†

- è¾¾åˆ° `MinPeers` ä¸ªæˆåŠŸè¿æ¥ â†’ å¼•å¯¼æˆåŠŸ
- å…¨éƒ¨è¿æ¥å¤±è´¥ â†’ `ErrAllConnectionsFailed`
- æˆåŠŸæ•°ä¸è¶³ â†’ `ErrMinPeersNotMet`

---

## æµ‹è¯•

```bash
go test -v ./internal/discovery/bootstrap/...
go test -cover ./internal/discovery/bootstrap/...
```

---

## ç›¸å…³æ–‡æ¡£

- [doc.go](doc.go) - åŒ…æ–‡æ¡£
- [DESIGN_REVIEW.md](DESIGN_REVIEW.md) - è®¾è®¡è¯„å®¡

---

**æœ€åæ›´æ–°**: 2026-01-20
