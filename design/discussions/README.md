# 设计讨论记录

本目录用于记录设计讨论过程、问题分析和决策推导。

---

## 概述

与正式设计文档不同，讨论记录是**过程性文档**：

- **设计文档**（其他目录）：记录最终结论，稳定、规范
- **讨论记录**（本目录）：记录讨论过程，可演进、可追溯

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    设计讨论 → 正式设计 的流转                                │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   discussions/                         正式设计文档                          │
│   ─────────────                        ─────────────                         │
│   DISC-xxx-*.md  ──结论沉淀──▶        architecture/*.md                     │
│   （讨论过程）                         adr/*.md                              │
│                                        invariants/*.md                       │
│                                        protocols/*.md                        │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 文件命名规范

**格式**：`DISC-<编号>-<主题>.md`

- **编号**：4 位日期编号（MMDD）或顺序编号
- **主题**：讨论主题的简短描述

**示例**：

```
discussions/
├── DISC-1227-api-layer-design.md       # API 分层设计讨论
├── DISC-1227-relay-isolation.md        # 中继隔离问题讨论
├── DISC-1228-realm-membership.md       # Realm 成员管理讨论
└── ...
```

---

## 讨论记录模板

```markdown
# DISC-XXXX-<主题>

**日期**：YYYY-MM-DD
**参与者**：@developer1, @developer2
**状态**：🔄 进行中 | ✅ 已结论 | 📋 待实施

---

## 背景

描述讨论的背景和触发原因。

## 问题分析

详细分析发现的问题。

## 讨论内容

记录讨论过程中的观点和分析。

## 结论

最终的设计决策。

## 后续行动

| 行动 | 负责人 | 状态 |
|------|--------|------|
| 更新架构文档 | @xxx | 🔄 |
| 创建 ADR | @xxx | 📋 |

## 关联文档

- → [ADR-xxxx](../adr/xxxx-xxx.md)
- → [架构文档](../architecture/xxx.md)
```

---

## 当前讨论记录

| 编号 | 主题 | 状态 | 结论去向 |
|------|------|------|---------|
| DISC-1227-api-layer-design | API 分层与对象产出设计 | ✅ 已结论 | → architecture/layers.md |
| DISC-1227-relay-isolation | 分层中继设计 | ✅ 已结论 | → protocols/transport/relay.md |

---

## 如何使用讨论记录

### 1. 发起新讨论

1. 创建新文件：`DISC-<编号>-<主题>.md`
2. 使用上述模板填写背景和问题
3. 记录讨论过程

### 2. 讨论结束后

1. 更新状态为 `✅ 已结论`
2. 将结论沉淀到正式设计文档
3. 在"关联文档"中添加链接
4. 更新本 README 的索引表

### 3. 追溯决策

当需要了解"为什么这样设计"时：
1. 查看正式设计文档
2. 如需更多背景，查找相关讨论记录

