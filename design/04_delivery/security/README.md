# 安全防护 (Security)

> 威胁模型、安全要求、安全审计

---

## 目录结构

```
security/
├── README.md              # 本文件
├── threat_model.md        # 威胁模型
├── security_requirements.md # 安全要求
├── audits/                # 安全审计
│   └── README.md
└── postmortems/           # 安全事件报告
    └── README.md
```

---

## 安全原则

| 原则 | 说明 |
|------|------|
| **身份优先** | 所有操作基于可验证身份 |
| **最小权限** | 组件只获取必要的权限 |
| **默认安全** | 安全选项应为默认 |
| **深度防御** | 多层安全机制 |
| **加密优先** | 敏感数据必须加密 |

---

## 威胁模型

### 威胁类别

| 类别 | 威胁 | 缓解措施 |
|------|------|----------|
| **身份** | NodeID 伪造 | Ed25519 签名验证 |
| **传输** | 中间人攻击 | TLS 1.3 + 双向认证 |
| **访问** | 未授权访问 | Realm PSK 认证 |
| **可用性** | DoS 攻击 | 连接限制、资源配额 |
| **数据** | 信息泄露 | 端到端加密 |

### STRIDE 分析

| 威胁 | 说明 | 对策 |
|------|------|------|
| **S**poofing | 身份伪造 | 密钥绑定身份 |
| **T**ampering | 数据篡改 | 消息签名 |
| **R**epudiation | 否认 | 操作日志 |
| **I**nformation Disclosure | 信息泄露 | 加密传输 |
| **D**enial of Service | 拒绝服务 | 资源限制 |
| **E**levation of Privilege | 权限提升 | 最小权限 |

---

## 安全要求

### 传输安全

- [x] TLS 1.3 加密
- [x] 双向身份认证
- [x] 完美前向保密 (PFS)

### 身份安全

- [x] Ed25519 密钥对
- [x] 密钥安全存储
- [x] NodeID 不可伪造

### 访问控制

- [x] Realm PSK 认证
- [x] 连接门控 (ConnectionGater)
- [x] 协议白名单

---

## 安全审计

### 审计计划

| 阶段 | 时间 | 范围 |
|------|------|------|
| 内部审计 | 持续 | 代码评审 |
| 外部审计 | 发布前 | 完整安全评估 |

### 审计记录

- [审计目录](audits/)

---

## 相关文档

- [威胁模型详情](threat_model.md)
- [安全要求](security_requirements.md)

---

**最后更新**：2026-01-11
