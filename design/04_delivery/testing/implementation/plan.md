# æµ‹è¯•æ”¹è¿›å®æ–½è®¡åˆ’

**åˆ›å»ºæ—¥æœŸ**: 2026-01-21  
**çŠ¶æ€**: æ‰§è¡Œä¸­  
**å…³è”æ–‡æ¡£**: 
- `../overview.md` (æ€»ä½“æ¦‚è§ˆ)
- `design/_discussions/20260120-testing-strategy-analysis.md` (è¯¦ç»†åˆ†æ)

---

## ä¸€ã€å®æ–½ç›®æ ‡

### 1.1 æ ¸å¿ƒç›®æ ‡

> **æµ‹è¯•æ˜¯æ‰‹æ®µï¼Œå‘ç° BUG æ˜¯ç›®çš„ï¼Œæ ¸å¿ƒæ˜¯ä¿®å¤ä»£ç ï¼Œç¡®ä¿æ²¡æœ‰æ½œåœ¨ç¼ºé™·ã€‚**

| ç›®æ ‡ | æŒ‡æ ‡ | å½“å‰çŠ¶æ€ | ç›®æ ‡çŠ¶æ€ |
|------|------|----------|----------|
| **æ¶ˆé™¤æ•°æ®ç«äº‰** | Race æ£€æµ‹é€šè¿‡ç‡ | éƒ¨åˆ†æ¨¡å—æœ‰ç«äº‰ | 100% é€šè¿‡ |
| **æå‡æµ‹è¯•è¦†ç›–** | æ ¸å¿ƒæ¨¡å—è¦†ç›–ç‡ | 60-70% | 80%+ |
| **æ¶ˆé™¤ä¼ªæµ‹è¯•** | æ— æ•ˆæµ‹è¯•æ•°é‡ | 50+ | 0 |
| **ä¿®å¤å·²çŸ¥ BUG** | BUG æ¸…å•æ•°é‡ | 34+ | 0 |
| **æµ‹è¯•ç¨³å®šæ€§** | æµ‹è¯•é€šè¿‡ç‡ | ~95% | 100% |

### 1.2 æ‰§è¡Œæˆæœï¼ˆå·²å®Œæˆéƒ¨åˆ†ï¼‰

| é˜¶æ®µ | çŠ¶æ€ | å®Œæˆæ—¶é—´ | æˆæœ |
|------|:----:|----------|------|
| **P0 æ¨¡å—å®¡æŸ¥** | âœ… å®Œæˆ | 2026-01-20 | 9ä¸ªæ ¸å¿ƒæ¨¡å—ï¼ŒBUG 5ä¸ªå·²ä¿®å¤ï¼Œä¼ªæµ‹è¯• 30+ å·²ä¿®å¤ |
| **P1 æ¨¡å—å®¡æŸ¥** | âœ… å®Œæˆ | 2026-01-21 | 6ä¸ªé‡è¦æ¨¡å—ï¼Œè¦†ç›–ç‡æå‡è‡³ 60%+ |
| **P2 æ¨¡å—å®¡æŸ¥** | âœ… å®Œæˆ | 2026-01-21 | 6ä¸ªæ ¸å¿ƒP2æ¨¡å—ï¼Œç¼–è¯‘é€šè¿‡ï¼Œ56/60æµ‹è¯•é€šè¿‡ |
| P2-30+ æ¨¡å—å®¡æŸ¥ | ğŸ”„ è¿›è¡Œä¸­ | è¿›è¡Œä¸­ | è¡¥å……å‰©ä½™æ¨¡å— |
| é›†æˆæµ‹è¯•éªŒè¯ | ğŸ“‹ å¾…å¯åŠ¨ | - | - |
| E2E æµ‹è¯•éªŒè¯ | ğŸ“‹ å¾…å¯åŠ¨ | - | - |

---

## äºŒã€å®æ–½ä¼˜å…ˆçº§

### 2.1 ä¼˜å…ˆçº§å®šä¹‰

| ä¼˜å…ˆçº§ | å®šä¹‰ | æ¨¡å—æ•° | å®¡æŸ¥é‡ç‚¹ |
|:------:|------|:------:|----------|
| **P0** | å®‰å…¨/æ ¸å¿ƒåŸºç¡€ | 9 | åŠ å¯†ã€è®¤è¯ã€è¿æ¥å®‰å…¨ |
| **P1** | ä¸»æµç¨‹åŠŸèƒ½ | 6 | çŠ¶æ€ç®¡ç†ã€å¹¶å‘ã€åè®®æ­£ç¡®æ€§ |
| **P2** | è¾…åŠ©åŠŸèƒ½ | 26+ | èµ„æºæ³„æ¼ã€è¾¹ç•Œæ¡ä»¶ |

### 2.2 P0 æ¨¡å—æ¸…å•ï¼ˆå·²å®Œæˆ âœ…ï¼‰

| åºå· | æ¨¡å— | è·¯å¾„ | çŠ¶æ€ | æµ‹è¯•æ•° | è¦†ç›–ç‡ | BUG |
|:----:|------|------|:----:|:------:|:------:|:---:|
| 1 | identity | `internal/core/identity` | âœ… | 81 | 81.5% | 0 |
| 2 | security | `internal/core/security` | âœ… | 15 | 76.7% | 0 |
| 3 | security/noise | `internal/core/security/noise` | âœ… | 24 | 67.1% | 1 å·²ä¿®å¤ |
| 4 | security/tls | `internal/core/security/tls` | âœ… | 48 | 70.9% | 1 å·²ä¿®å¤ |
| 5 | transport | `internal/core/transport` | âœ… | 7 | 44.9% | 0 |
| 6 | transport/quic | `internal/core/transport/quic` | âœ… | 26 | 72.4% | 0 |
| 7 | transport/tcp | `internal/core/transport/tcp` | âœ… | 37 | 83.0% | 0 |
| 8 | host | `internal/core/host` | âœ… | 99 | 71.8% | 0 |
| 9 | dht | `internal/discovery/dht` | âœ… | 56 | 61.2% | 0 |

### 2.3 P1 æ¨¡å—æ¸…å•ï¼ˆå·²å®Œæˆ âœ…ï¼‰

| åºå· | æ¨¡å— | è·¯å¾„ | çŠ¶æ€ | æµ‹è¯•æ•° | è¦†ç›–ç‡ | BUG |
|:----:|------|------|:----:|:------:|:------:|:---:|
| 1 | swarm | `internal/core/swarm` | âœ… | ~80 | 66.8% | 0 |
| 2 | peerstore | `internal/core/peerstore` | âœ… | ~100 | 82.1% | 0 |
| 3 | pubsub | `internal/protocol/pubsub` | âœ… | 82 | 50.6% | 0 |
| 4 | streams | `internal/protocol/streams` | âœ… | 21 | 55.9% | 0 |
| 5 | auth | `internal/realm/auth` | âœ… | 51 | 60.8% | 0 |
| 6 | member | `internal/realm/member` | âœ… | 61 | 53.5% | 1 å·²ä¿®å¤ |

### 2.4 P2 æ¨¡å—æ¸…å•ï¼ˆéƒ¨åˆ†å®Œæˆï¼‰

| åºå· | æ¨¡å— | è·¯å¾„ | çŠ¶æ€ | è¦†ç›–ç‡ |
|:----:|------|------|:----:|:------:|
| 1 | connmgr | `internal/core/connmgr` | âœ… | 63-88% |
| 2 | eventbus | `internal/core/eventbus` | âœ… | 86.7% |
| 3 | metrics | `internal/core/metrics` | âœ… | 73.9% |
| 4 | resourcemgr | `internal/core/resourcemgr` | âœ… | 83.8% |
| 5 | relay | `internal/core/relay` | âœ… | 25-53% |
| 6 | nat | `internal/core/nat` | âœ… | 0-42% |
| 7+ | å…¶ä»– | - | ğŸ”„ | - |

---

## ä¸‰ã€å®æ–½é˜¶æ®µ

### Phase 1: å•å…ƒæµ‹è¯•å®¡æŸ¥ä¸ä¿®å¤ï¼ˆå·²å®Œæˆå¤§éƒ¨åˆ† âœ…ï¼‰

#### 3.1 æ‰§è¡Œæ­¥éª¤

```bash
# æ­¥éª¤ 1: åŸºçº¿æµ‹è¯•
go test ./... -short 2>&1 | tee test-baseline.log

# æ­¥éª¤ 2: Race æ£€æµ‹
go test -race ./... -short -timeout 10m 2>&1 | tee race-baseline.log

# æ­¥éª¤ 3: è¦†ç›–ç‡åŸºçº¿
go test ./... -coverprofile=coverage.out -timeout 5m
go tool cover -func=coverage.out | grep -E "^(github|total)" > coverage-baseline.txt

# æ­¥éª¤ 4: æ¨¡å—é€ä¸ªå®¡æŸ¥ï¼ˆP0 â†’ P1 â†’ P2ï¼‰
for module in identity security transport host dht; do
  echo "å®¡æŸ¥æ¨¡å—: $module"
  go test -race -v ./internal/**/$module/... -timeout 5m
  go test -coverprofile=cov-$module.out ./internal/**/$module/...
  go tool cover -html=cov-$module.out -o coverage-$module.html
done
```

#### 3.2 å®¡æŸ¥æ¸…å•ï¼ˆæ¯ä¸ªæ¨¡å—ï¼‰

- [ ] åˆ—å‡ºæ‰€æœ‰ exported API
- [ ] åˆ—å‡ºæ‰€æœ‰æµ‹è¯•å‡½æ•°
- [ ] è¯†åˆ«æœªè¦†ç›–çš„ API
- [ ] è¯†åˆ«ä¼ªæµ‹è¯•ï¼ˆç©ºæ–­è¨€ã€æ°¸çœŸç­‰ï¼‰
- [ ] æ£€æŸ¥é”™è¯¯è·¯å¾„è¦†ç›–
- [ ] æ£€æŸ¥è¾¹ç•Œæ¡ä»¶è¦†ç›–
- [ ] æ£€æŸ¥å¹¶å‘æµ‹è¯•
- [ ] è¿è¡Œ Race æ£€æµ‹
- [ ] è®°å½•å‘ç°çš„ BUG
- [ ] ä¿®å¤ BUG
- [ ] è¡¥å……ç¼ºå¤±æµ‹è¯•
- [ ] ä¿®å¤ä¼ªæµ‹è¯•

#### 3.3 å·²å‘ç°å¹¶ä¿®å¤çš„å…³é”® BUG

| ID | æ¨¡å— | ç±»å‹ | ä¸¥é‡åº¦ | çŠ¶æ€ |
|:--:|------|------|:------:|:----:|
| B3 | realm/realm.go | Race ç«äº‰ | ğŸ”´ | âœ… å·²ä¿®å¤ |
| B7 | security/tls | æµ‹è¯•æ­»é” | ğŸ”´ | âœ… å·²ä¿®å¤ |
| B9 | member/cache | æ­»é” | ğŸ”´ | âœ… å·²ä¿®å¤ |
| B13 | relay/autorelay | Race ç«äº‰ | ğŸ”´ | âœ… å·²ä¿®å¤ |
| B17 | relay/server | å†…å­˜æ”»å‡» | ğŸ”´ | âœ… å·²ä¿®å¤ |
| B20 | swarm/listen | Panic | ğŸŸ¡ | âœ… å·²ä¿®å¤ |
| B21 | mdns | Panic | ğŸŸ¡ | âœ… å·²ä¿®å¤ |
| B33 | muxer | Goroutineæ³„æ¼ | ğŸ”´ | âœ… å·²ä¿®å¤ |
| B34 | identify | Panic | ğŸ”´ | âœ… å·²ä¿®å¤ |

**æ€»è®¡**: 34+ BUG å·²ä¿®å¤

---

### Phase 2: é›†æˆæµ‹è¯•éªŒè¯ï¼ˆå¾…å¯åŠ¨ ğŸ“‹ï¼‰

#### 3.4 éªŒè¯èŒƒå›´

| æµ‹è¯•ç±»å‹ | è·¯å¾„ | å‘½ä»¤ | é¢„è®¡è€—æ—¶ |
|----------|------|------|----------|
| é›†æˆæµ‹è¯• | `tests/integration/` | `go test -tags=integration -race ./tests/integration/... -v -timeout 5m` | 5-10 åˆ†é’Ÿ |

#### 3.5 æ‰§è¡Œæ­¥éª¤

```bash
# æ­¥éª¤ 1: ç¡®è®¤é›†æˆæµ‹è¯•å¯ç¼–è¯‘
go test -tags=integration -c ./tests/integration/...

# æ­¥éª¤ 2: è¿è¡Œé›†æˆæµ‹è¯•
go test -tags=integration -race ./tests/integration/... -v -timeout 5m 2>&1 | tee integration-test.log

# æ­¥éª¤ 3: åˆ†æå¤±è´¥åŸå› 
grep -E "FAIL|panic" integration-test.log

# æ­¥éª¤ 4: ä¿®å¤å¤±è´¥æµ‹è¯•
# ï¼ˆé€ä¸ªä¿®å¤ï¼‰

# æ­¥éª¤ 5: ç¡®è®¤æ‰€æœ‰æµ‹è¯•é€šè¿‡
go test -tags=integration -race ./tests/integration/... -v
```

#### 3.6 é‡ç‚¹æµ‹è¯•åœºæ™¯

| åœºæ™¯ | æ¶‰åŠæ¨¡å— | ä¼˜å…ˆçº§ |
|------|----------|--------|
| èŠ‚ç‚¹è¿æ¥å»ºç«‹ | Host + Swarm + Transport + Security | P0 |
| Realm è®¤è¯ | Host + Realm + Security | P0 |
| æˆå‘˜å‘ç° | Realm + Member + PubSub | P0 |
| ç¾¤èŠæ¶ˆæ¯ | PubSub + Realm + Streams | P0 |
| ç§èŠæ¶ˆæ¯ | Streams + Realm | P0 |
| DHT èŠ‚ç‚¹å‘ç° | Discovery + DHT + Host | P1 |
| ä¸­ç»§é€šä¿¡ | Relay + Host + Swarm | P1 |
| äº‹ä»¶ä¼ æ’­ | EventBus + å„æ¨¡å— | P1 |

---

### Phase 3: E2E æµ‹è¯•éªŒè¯ï¼ˆå¾…å¯åŠ¨ ğŸ“‹ï¼‰

#### 3.7 éªŒè¯èŒƒå›´

| æµ‹è¯•ç±»å‹ | è·¯å¾„ | å‘½ä»¤ | é¢„è®¡è€—æ—¶ |
|----------|------|------|----------|
| E2E æµ‹è¯• | `tests/e2e/` | `go test -tags=e2e -race ./tests/e2e/... -v -timeout 10m` | 10-15 åˆ†é’Ÿ |

#### 3.8 E2E åœºæ™¯

| åœºæ™¯ | æ–‡ä»¶ | è¯´æ˜ |
|------|------|------|
| èŠå¤©åœºæ™¯ | `scenario/chat_test.go` | å¯¹æ ‡ examples/chat |
| å‘ç°åœºæ™¯ | `scenario/discovery_test.go` | èŠ‚ç‚¹å‘ç°æµç¨‹ |
| NAT ç©¿é€ | `network/nat_traversal_test.go` | æœ¬åœ°æ¨¡æ‹Ÿ NAT |
| ä¸­ç»§å›é€€ | `network/relay_fallback_test.go` | ä¸­ç»§é€šä¿¡ |
| ç½‘ç»œåˆ†åŒº | `resilience/partition_test.go` | åˆ†åŒºæ¢å¤ |
| æ•…éšœæ¢å¤ | `resilience/recovery_test.go` | èŠ‚ç‚¹é‡å¯ |

---

### Phase 4: CI/CD é›†æˆï¼ˆå¾…å¯åŠ¨ ğŸ“‹ï¼‰

#### 3.9 CI é…ç½®

åˆ›å»º `.github/workflows/test.yml`:

```yaml
name: Tests

on: [push, pull_request]

jobs:
  unit:
    name: Unit Tests
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-go@v5
        with:
          go-version: '1.22'
      - name: Unit Tests
        run: go test ./... -short -timeout 5m

  race:
    name: Race Detection
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-go@v5
        with:
          go-version: '1.22'
      - name: Race Detection
        run: go test -race ./... -short -timeout 10m

  integration:
    name: Integration Tests
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-go@v5
        with:
          go-version: '1.22'
      - name: Integration Tests
        run: go test -tags=integration -race ./tests/integration/... -v -timeout 10m

  e2e:
    name: E2E Tests
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-go@v5
        with:
          go-version: '1.22'
      - name: E2E Tests
        run: go test -tags=e2e -race ./tests/e2e/... -v -timeout 15m
```

---

### Phase 5: çœŸå®ç½‘ç»œéªŒè¯ï¼ˆè§„åˆ’ä¸­ ğŸ“‹ï¼‰

#### 3.10 éªŒè¯ç¯å¢ƒ

| èŠ‚ç‚¹ç±»å‹ | æ•°é‡ | ç½‘ç»œç¯å¢ƒ | ç”¨é€” |
|----------|:----:|----------|------|
| äº‘æœåŠ¡å™¨ | 2-3 | å…¬ç½‘ | å¼•å¯¼èŠ‚ç‚¹ã€ä¸­ç»§æœåŠ¡å™¨ |
| WiFi èŠ‚ç‚¹ | 2 | NAT å | æ¨¡æ‹Ÿå®¶åº­/åŠå…¬å®¤ç½‘ç»œ |
| 4G èŠ‚ç‚¹ | 1-2 | NAT å | æ¨¡æ‹Ÿç§»åŠ¨ç½‘ç»œ |

#### 3.11 éªŒè¯åœºæ™¯

å‚è€ƒ `design/_discussions/20260120-distributed-validation-framework.md`:

| åœºæ™¯ | ç›®æ ‡ | éªŒè¯å†…å®¹ |
|------|------|----------|
| S01: åŸºç¡€ä¸‰èŠ‚ç‚¹é€šä¿¡ | éªŒè¯åŸºæœ¬è¿æ¥ | è¿æ¥å»ºç«‹ã€æ¶ˆæ¯ä¼ é€’ |
| S02: NAT ç©¿é€éªŒè¯ | éªŒè¯ NAT ç©¿é€ | Holepunchã€STUN |
| S03: ä¸­ç»§å›é€€éªŒè¯ | éªŒè¯ä¸­ç»§é€šä¿¡ | ä¸­ç»§å»ºç«‹ã€æ•°æ®è½¬å‘ |
| S04: ç½‘ç»œåˆ†åŒºæ¢å¤ | éªŒè¯éŸ§æ€§ | ç½‘ç»œåˆ‡æ¢ã€é‡è¿ |

---

## å››ã€æ—¶é—´è®¡åˆ’

### 4.1 å·²å®Œæˆé˜¶æ®µ

| é˜¶æ®µ | å·¥ä½œé‡ | å¼€å§‹æ—¥æœŸ | å®Œæˆæ—¥æœŸ | çŠ¶æ€ |
|------|--------|----------|----------|:----:|
| Phase 1 - P0 æ¨¡å— | 1 å¤© | 2026-01-20 | 2026-01-20 | âœ… |
| Phase 1 - P1 æ¨¡å— | 1 å¤© | 2026-01-21 | 2026-01-21 | âœ… |
| Phase 1 - P2 éƒ¨åˆ†æ¨¡å— | 0.5 å¤© | 2026-01-21 | 2026-01-21 | âœ… |

### 4.2 å¾…æ‰§è¡Œé˜¶æ®µ

| é˜¶æ®µ | å·¥ä½œé‡ | é¢„è®¡å¼€å§‹ | é¢„è®¡å®Œæˆ | çŠ¶æ€ |
|------|--------|----------|----------|:----:|
| Phase 1 - P2 å‰©ä½™æ¨¡å— | 0.5 å¤© | - | - | ğŸ“‹ |
| Phase 2 - é›†æˆæµ‹è¯• | 0.5 å¤© | - | - | ğŸ“‹ |
| Phase 3 - E2E æµ‹è¯• | 0.5 å¤© | - | - | ğŸ“‹ |
| Phase 4 - CI/CD | 0.5 å¤© | - | - | ğŸ“‹ |
| Phase 5 - çœŸå®ç½‘ç»œéªŒè¯ | 1-2 å¤© | - | - | ğŸ“‹ |

---

## äº”ã€é£é™©ä¸åº”å¯¹

### 5.1 é£é™©è¯†åˆ«

| é£é™© | å¯èƒ½æ€§ | å½±å“ | åº”å¯¹æªæ–½ |
|------|:------:|:----:|----------|
| å‘ç°æ›´å¤šå…³é”® BUG | é«˜ | é«˜ | ç«‹å³ä¿®å¤ï¼Œå»¶åéå…³é”®ä»»åŠ¡ |
| æµ‹è¯•ä¸ç¨³å®šï¼ˆFlakyï¼‰ | ä¸­ | ä¸­ | è¯†åˆ«åŸå› ï¼Œä¿®å¤æˆ–éš”ç¦» |
| CI è¶…æ—¶ | ä¸­ | ä½ | ä¼˜åŒ–æµ‹è¯•å¹¶è¡Œåº¦ï¼Œè°ƒæ•´è¶…æ—¶ |
| é›†æˆæµ‹è¯•å¤±è´¥ | ä¸­ | é«˜ | é€ä¸ªåœºæ™¯è°ƒè¯•ï¼Œå¿…è¦æ—¶é™çº§ |
| çœŸå®ç½‘ç»œç¯å¢ƒé—®é¢˜ | é«˜ | ä¸­ | å‡†å¤‡å¤‡ç”¨ç¯å¢ƒï¼Œæ—¥å¿—è¯¦ç»†åŒ– |

### 5.2 åº”å¯¹ç­–ç•¥

| ç­–ç•¥ | è¯´æ˜ |
|------|------|
| **å¢é‡å®æ–½** | æŒ‰ä¼˜å…ˆçº§é€æ­¥æ¨è¿›ï¼ŒP0 â†’ P1 â†’ P2 |
| **å¿«é€Ÿåé¦ˆ** | æ¯ä¸ªæ¨¡å—å®¡æŸ¥åç«‹å³è¿è¡Œæµ‹è¯• |
| **å¹¶è¡Œæ‰§è¡Œ** | ä¸åŒå±‚çº§çš„æ¨¡å—å¯å¹¶è¡Œå®¡æŸ¥ |
| **æ–‡æ¡£è®°å½•** | æ‰€æœ‰ BUG å’Œå†³ç­–éƒ½è®°å½•åœ¨æ¡ˆ |
| **æŒç»­é›†æˆ** | å°½æ—©æ¥å…¥ CIï¼Œå¿«é€Ÿå‘ç°å›å½’ |

---

## å…­ã€æˆåŠŸæ ‡å‡†

### 6.1 é˜¶æ®µæ€§æ ‡å‡†

| é˜¶æ®µ | æˆåŠŸæ ‡å‡† |
|------|----------|
| Phase 1 å®Œæˆ | â€¢ æ‰€æœ‰ P0/P1 æ¨¡å—è¦†ç›–ç‡è¾¾æ ‡<br>â€¢ æ‰€æœ‰ Race æ£€æµ‹é€šè¿‡<br>â€¢ æ‰€æœ‰ä¼ªæµ‹è¯•ä¿®å¤<br>â€¢ å…³é”® BUG å…¨éƒ¨ä¿®å¤ |
| Phase 2 å®Œæˆ | â€¢ æ‰€æœ‰é›†æˆæµ‹è¯•é€šè¿‡<br>â€¢ è·¨æ¨¡å—åœºæ™¯éªŒè¯é€šè¿‡ |
| Phase 3 å®Œæˆ | â€¢ æ‰€æœ‰ E2E æµ‹è¯•é€šè¿‡<br>â€¢ ç”¨æˆ·åœºæ™¯éªŒè¯é€šè¿‡ |
| Phase 4 å®Œæˆ | â€¢ CI æµç¨‹å»ºç«‹<br>â€¢ æ‰€æœ‰æ£€æŸ¥è‡ªåŠ¨åŒ– |
| Phase 5 å®Œæˆ | â€¢ çœŸå®ç½‘ç»œéªŒè¯é€šè¿‡<br>â€¢ NAT/Relay éªŒè¯é€šè¿‡ |

### 6.2 æœ€ç»ˆæ ‡å‡†

| æŒ‡æ ‡ | ç›®æ ‡ | éªŒè¯æ–¹å¼ |
|------|------|----------|
| **ç¼–è¯‘é€šè¿‡** | 100% | `go build ./...` |
| **å•å…ƒæµ‹è¯•é€šè¿‡** | 100% | `go test ./...` |
| **Race æ£€æµ‹é€šè¿‡** | 100% | `go test -race ./...` |
| **é›†æˆæµ‹è¯•é€šè¿‡** | 100% | `go test -tags=integration ./tests/integration/...` |
| **E2E æµ‹è¯•é€šè¿‡** | 100% | `go test -tags=e2e ./tests/e2e/...` |
| **æ ¸å¿ƒæ¨¡å—è¦†ç›–ç‡** | â‰¥ 80% | `go tool cover` |
| **æ€»ä½“è¦†ç›–ç‡** | â‰¥ 70% | `go tool cover` |
| **å·²çŸ¥ BUG** | 0 | BUG è·Ÿè¸ªæ¸…å• |
| **ä¼ªæµ‹è¯•** | 0 | ä»£ç å®¡æŸ¥ |

---

## ä¸ƒã€ç›¸å…³æ–‡æ¡£

| æ–‡æ¡£ | æè¿° |
|------|------|
| `../overview.md` | æµ‹è¯•ç­–ç•¥æ”¹è¿›æ¦‚è§ˆ |
| `../strategy/test_strategy.md` | æµ‹è¯•ç­–ç•¥è¯¦ç»†æ–‡æ¡£ |
| `../strategy/quality_gates.md` | è´¨é‡é—¨ç¦ |
| `../audits/module_audits.md` | æ¨¡å—å®¡æŸ¥æŠ¥å‘Š |
| `design/_discussions/20260120-testing-strategy-analysis.md` | è¯¦ç»†åˆ†ææ–‡æ¡£ï¼ˆ5440è¡Œï¼‰ |
| `design/_discussions/20260120-distributed-validation-framework.md` | åˆ†å¸ƒå¼éªŒè¯æ¡†æ¶ |

---

## å…«ã€å¿«é€Ÿæ–­å¼€æ£€æµ‹æµ‹è¯•è¿½è¸ª

> å…³è”æ–‡æ¡£: `fast-disconnect-detection-impl.md`

### 8.1 å®æ–½çŠ¶æ€

| ç»„ä»¶ | æ–‡ä»¶è·¯å¾„ | å®ç°çŠ¶æ€ | æµ‹è¯•çŠ¶æ€ |
|------|---------|:--------:|:--------:|
| è§è¯äººæœåŠ¡ | `internal/realm/witness/service.go` | âœ… | â³ å¾…è¡¥å…… |
| æŠ•ç¥¨ä¼šè¯ | `internal/realm/witness/voting.go` | âœ… | â³ å¾…è¡¥å…… |
| é™é€Ÿå™¨ | `internal/realm/witness/ratelimit.go` | âœ… | â³ å¾…è¡¥å…… |
| æˆå‘˜çŠ¶æ€æœº | `internal/realm/member/state.go` | âœ… | â³ å¾…è¡¥å…… |
| éœ‡è¡æ£€æµ‹å™¨ | `internal/realm/stability/tracker.go` | âœ… | â³ å¾…è¡¥å…… |
| æ–­å¼€ä¿æŠ¤æœŸ | `internal/realm/member/protection.go` | âœ… | â³ å¾…è¡¥å…… |
| å¥åº·æ£€æŸ¥å™¨ | `internal/core/swarm/health.go` | âœ… | â³ å¾…è¡¥å…… |
| Relay è§è¯æ‰©å±• | `internal/core/relay/server/witness.go` | âœ… | â³ å¾…è¡¥å…… |

### 8.2 å¾…å®ç°æµ‹è¯•ç”¨ä¾‹

| æµ‹è¯•æ–‡ä»¶ | æµ‹è¯•ç”¨ä¾‹ | ä¼˜å…ˆçº§ | çŠ¶æ€ |
|---------|---------|:------:|:----:|
| `witness/service_test.go` | `TestWitnessReport` | P0 | â³ |
| `witness/service_test.go` | `TestFastPathConfirm` | P0 | â³ |
| `witness/voting_test.go` | `TestVotingQuorum` | P1 | â³ |
| `witness/voting_test.go` | `TestSingleAgreeNoDisagree` | P1 | â³ |
| `witness/ratelimit_test.go` | `TestRateLimitPerMinute` | P1 | â³ |
| `member/state_test.go` | `TestGracePeriod` | P0 | â³ |
| `member/state_test.go` | `TestReconnectDuringGrace` | P0 | â³ |
| `member/protection_test.go` | `TestDisconnectProtection` | P0 | â³ |
| `stability/tracker_test.go` | `TestFlappingDetection` | P1 | â³ |
| `stability/tracker_test.go` | `TestFlappingRecovery` | P1 | â³ |

### 8.3 é›†æˆæµ‹è¯•åœºæ™¯

| åœºæ™¯ | æµ‹è¯•æ–¹æ³• | æœŸæœ›ç»“æœ | çŠ¶æ€ |
|------|---------|---------|:----:|
| ä¼˜é›…æ–­å¼€ | `node.Stop()` | < 100ms æ‰€æœ‰æˆå‘˜æ„ŸçŸ¥ | â³ |
| ç›´è¿éä¼˜é›…æ–­å¼€ | `kill -9` | < 10s ç›´è¿èŠ‚ç‚¹æ„ŸçŸ¥ | â³ |
| ä¸­ç»§éä¼˜é›…æ–­å¼€ | æ–­å¼€ NAT èŠ‚ç‚¹ç½‘ç»œ | < 15s Relay ä»£ç†é€šçŸ¥ | â³ |
| 4G/WiFi åˆ‡æ¢ | æ¨¡æ‹Ÿç½‘ç»œåˆ‡æ¢ï¼ˆæ–­å¼€5såé‡è¿ï¼‰ | å®½é™æœŸå†…é‡è¿æˆåŠŸï¼Œä¸ç§»é™¤æˆå‘˜ | â³ |
| ç½‘ç»œéœ‡è¡ | 60så†…3æ¬¡æ–­å¼€/é‡è¿ | è§¦å‘éœ‡è¡æŠ‘åˆ¶ï¼Œæš‚åœçŠ¶æ€å˜æ›´ | â³ |
| æ–­å¼€ä¿æŠ¤æœŸ | æ–­å¼€åç«‹å³é€šè¿‡ PubSub é‡æ–°æ·»åŠ  | ä¿æŠ¤æœŸå†…è¢«æ‹’ç» | â³ |
| è§è¯äººé™é€Ÿ | å•è§è¯äººè¿ç»­å‘é€ 15 ä¸ªæŠ¥å‘Š | è¶…è¿‡ 10 ä¸ªåè¢«é™é€Ÿ | â³ |

### 8.4 éªŒæ”¶æ ‡å‡†

| æ ‡å‡† | è¦æ±‚ | å½“å‰çŠ¶æ€ |
|------|------|:--------:|
| åŠŸèƒ½å®Œæ•´ | å››å±‚æ£€æµ‹ + é˜²è¯¯åˆ¤æœºåˆ¶å…¨éƒ¨å®ç° | âœ… |
| å»¶è¿Ÿè¾¾æ ‡ | ç›´è¿ < 10sï¼Œä¸­ç»§ < 15s | â³ å¾…éªŒè¯ |
| è¯¯åˆ¤å¯æ§ | æ­£å¸¸ç½‘ç»œè¯¯æ–­ç‡ < 1% | â³ å¾…éªŒè¯ |
| å®½é™æœŸæœ‰æ•ˆ | ç½‘ç»œåˆ‡æ¢ï¼ˆ5s æ–­å¼€ï¼‰ä¸è§¦å‘æˆå‘˜ç§»é™¤ | â³ å¾…éªŒè¯ |
| éœ‡è¡æŠ‘åˆ¶æœ‰æ•ˆ | 60s å†… 3 æ¬¡æ–­å¼€/é‡è¿è§¦å‘æŠ‘åˆ¶ | â³ å¾…éªŒè¯ |
| ä¿æŠ¤æœŸæœ‰æ•ˆ | æ–­å¼€å 30s å†…ä¸è¢«é‡æ–°æ·»åŠ  | â³ å¾…éªŒè¯ |
| é™é€Ÿæœ‰æ•ˆ | å•è§è¯äººæ¯åˆ†é’Ÿæœ€å¤š 10 ä¸ªæŠ¥å‘Š | â³ å¾…éªŒè¯ |
| æµ‹è¯•è¦†ç›– | æ ¸å¿ƒè·¯å¾„è¦†ç›–ç‡ > 80% | â³ å¾…éªŒè¯ |

---

**æœ€åæ›´æ–°**: 2026-01-29  
**ä¸‹ä¸€æ­¥**: å®Œæˆ P2 å‰©ä½™æ¨¡å—å®¡æŸ¥ï¼Œå¯åŠ¨é›†æˆæµ‹è¯•éªŒè¯ï¼Œè¡¥å……å¿«é€Ÿæ–­å¼€æ£€æµ‹æµ‹è¯•ç”¨ä¾‹
